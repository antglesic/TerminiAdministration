@page "/players"
@using TerminiWeb.Infrastructure.PlayerService.Dtos

@if (_players == null)
{
	<p><em>Loading...</em></p>
}
else
{
	<MudText HtmlTag="span">Item: @_selectedItemText</MudText>
	<MudText>Selected items (@_selectedPlayer != null ? 1 : 0): @(_selectedPlayer == null ? "" : _selectedItemText)</MudText>


	<MudTable @ref="_table" T="PlayerDto" Items="@_players" MultiSelection="true" Hover="true"
			  @bind-SelectedItem="@_selectedPlayer" @bind-SelectedItems="@_selectedItems" OnRowClick="@OnRowClick" SelectOnRowClick="@_selectOnRowClick"
			  RowsPerPage="@_pageSize" CurrentPage="@_pageNumber" CurrentPageChanged="CurrentPageNumberChanged" RowsPerPageChanged="CurrentPageSizeChanged"
			  Filter="new Func<PlayerDto, bool>(FilterFunction)">

		<ToolBarContent>
			<MudText Typo="Typo.h6">Players list</MudText>
			<MudSpacer />
			<MudTextField T="string" ValueChanged="@(s => OnSearch(s))" Placeholder="Search" Adornment="Adornment.Start"
						  AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
		</ToolBarContent>

		<HeaderContent>
			<MudTh> Id </MudTh>
			<MudTh> Active </MudTh>
			<MudTh> DateCreated </MudTh>
		</HeaderContent>

		<RowTemplate>
			<MudTd DataLabel="Id">@context.Id</MudTd>
			<MudTd DataLabel="Active">@context.Active</MudTd>
			<MudTd DataLabel="DateCreated">@context.DateCreated</MudTd>
		</RowTemplate>

		<NoRecordsContent>
			<MudText>No matching records found</MudText>
		</NoRecordsContent>

		<LoadingContent>
			<MudText>Loading...</MudText>
		</LoadingContent>

		<PagerContent>
			<MudTablePager PageSizeOptions="new int[] { 1, 2, 5, 10, 25, 50, 100 }" />
		</PagerContent>

		<FooterContent>
			<MudTd colspan="5">Select All</MudTd>
		</FooterContent>

	</MudTable>

	if (_selectedPlayer != null)
	{
		<MudPaper Class="pa-4 mt-4">
			<MudText Typo="Typo.h6">Selected Item</MudText>
			<MudItem>@($"Id: {_selectedPlayer.Id} => Active: {_selectedPlayer.Active} => DateCreated: {_selectedPlayer.DateCreated}")</MudItem>
		</MudPaper>
	}
	else
	{
		<MudText Typo="Typo.h6"> No Item was selected! </MudText>
	}

	<MudText HtmlTag="span">Selected items: @(_selectedItems == null ? "" : string.Join(", ", _selectedItems.OrderBy(x => x.Id).Select(x => x.Id)))</MudText>
}